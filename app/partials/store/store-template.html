<alert type="{{message.type}}" ng-show="message.message" close="message.closeMessage()" role="alert">
	{{message.message}}
</alert>
					
<section id="main-nav-and-sorting" class="col-xs-12 clearfix">
		<br>
		<div ng-controller="calendarCtrl" class="clearfix">
			<a href="/calendar"><i class="fa fa-calendar pull-left fa-4x"></i></a>
			<p>
				<i class="fa fa-cloud-upload fa-fw"></i> Product Uploading: {{inDateRange(countDown[0].ProductUploadStart, countDown[0].ProductUploadStop)}}.<br>
				<i class="fa fa-shopping-cart fa-fw"></i> Shopping: {{inDateRange(countDown[0].ShoppingStart, countDown[0].ShoppingStop)}}.<br>
				<i class="fa fa-gift fa-fw"></i> Delivery Day: <span class="label label-default">{{daysBeforeDeliveryDay}}</span> days<br>
				<span ng-if="daysBeforeDeliveryDay < 1">Next delivery day in {{countDown[1].DeliveryDay.daysUntil}} days</span>
			</p>
		</div>
		<br>
				
    <div ng-class="{ 'pull-left' : !panelDisplay}" class="hidden-sm hidden-xs">
    	<label> Categories: </label>
		<div class="btn-group">
			<button type='button' class="btn btn-default" ng-model="category" btn-radio="'Produce'" >Produce</button>
			<button type='button' class="btn btn-default" ng-model="category" btn-radio="'Meat'" >Meat</button>
			<button type='button' class="btn btn-default" ng-model="category" btn-radio="'Processed-Goods'" >Processed Goods</button>
			<button type='button' class="btn btn-default" ng-model="category" btn-radio="'Baked Goods'" >Baked Goods</button>
			<button type='button' class="btn btn-default" ng-model="category" btn-radio="'Dairy & Eggs'" >Dairy &amp; Eggs</button>
			<button type='button' class="btn btn-default" ng-model="category" btn-radio="'Tea & Beverages'" >Tea &amp; Beverages</button>
			<button type='button' class="btn btn-default" ng-model="category" btn-radio="null">All</button>
		</div>
	</div>
	
	<div class="btn-group visible-sm visible-xs" dropdown>
		<button class='btn btn-default dropdown-toggle'>Categories <span class="caret"></span></button>
		<ul class="dropdown-menu" role="menu">
	        <li><a ng-click="category = 'Produce'">Produce</a></li>
	        <li><a ng-click="category = 'Meat'">Meat</a></li>
	        <li><a ng-click="category = 'Processed-Goods'">Processed Goods</a></li>
	        <li><a ng-click="category = 'Baked Goods'">Baked Goods</a></li>
	        <li><a ng-click="category = 'Dairy & Eggs'">Dairy &amp; Eggs</a></li>
					<li><a ng-click="category = 'Tea & Beverages'">Tea &amp; Beverages</a></li>
	        <li class="divider"></li>
	        <li><a ng-click="category = null">Show All</a></li>
	    </ul>
	</div>
	   
						
	<div ng-class="{ 'pull-right' : !panelDisplay, 'sort-buttons-menu-open' : panelDisplay }" ng-show="products.length > 1">
		<label> Sort: </label>
		<div class="btn-group">
			<button type='button' class="btn btn-primary" 
			ng-click="sort = 'producer_ID.producerData.companyName' || 'producer_ID.name'; reverse=!reverse">
				 <span class="glyphicon glyphicon-sort"></span>  Producer
			</button>
			<button type='button' class="btn btn-primary" 
			ng-click="sort = 'fullName' || 'productName'; reverse=!reverse">
				  <span class="glyphicon glyphicon-sort"></span>  Alphabetical
			</button>
			<button type='button' class="btn btn-primary" 
			ng-click="sort = 'price'; reverse=!reverse">  <span class="glyphicon glyphicon-sort"></span>  Price</button>
		</div>
	</div>
           
</section>

<div id="products-section" class="col-xs-12">
	<div ng-show="!isProducts" class="col-md-8 col-md-offset-2">
		<div class="jumbotron">
			<h1 class="text-center">What? No Products?</h1>
			<p>This happens when no members have uploaded products for this month yet.</p>
			<p>Please be patient and check back when <a href="/calendar">shopping</a> starts again.</p>
		</div>
	</div>
	
	<ul id="store-products" class="list-unstyled">
		<li ng-repeat="product in products | orderBy:sort:reverse | filter:search | filter:category " class="product-container" 
		ng-controller="productUICtrl" 
		ng-mouseleave="detailsVisible = false"
		ng-swipe-left="detailsVisible = true;"
		>
			<figure class="first-layer" ng-mouseover="callDelayed()" ng-mouseleave="callCancelled()">
				<img
				ng-if="product.certification.name !== 'none' && product.img && product.certification.img"
				ng-src="img/certification/{{product.certification.img}}" class="certification-img" alt="organic certification">
				<img ng-src="{{product.img}}" class="img-responsive" alt="product image" ng-click="open(product)">
				<figcaption>
					<div class="btn-group pull-right">
						<button class="btn btn-primary pull-right" 
						ng-click="addToCart(product)" ng-if="!product.AlreadyInCart" 
						ng-hide="product.quantity <= 0">
							Add to Cart
						</button>
						<button class="btn btn-primary pull-right" disabled ng-if="product.AlreadyInCart">
							Added to Cart
						</button>
						<button class="btn btn-danger pull-right" disabled ng-if="product.quantity === 0">
							SOLD OUT
						</button>
						<br>
						<span class="pull-right visible-xs visible-sm"
						tooltip-placement="left" 
						tooltip="Swipe left for more info"
						tooltip-trigger="click"><i class="fa fa-chevron-circle-left"> swipe</i></span>
					</div>
					<h3>{{product.fullName}}</h3>
					<p>{{product.priceWithMarkup|currency}} / {{product.units}}</p>
				</figcaption>
			</figure>
			<section class="details-layer"  ng-class="{ 'details-layer-visible' : detailsVisible}" ng-mouseleave="detailsVisible = false" ng-swipe-right="showHideDetails(false)" ng-swipe-left="open(product)">
				
				<article class="details">
					<a href="" class="panel-btn-lg pull-left hidden-lg details-close-button" ng-click="detailsVisible = false">&times; </a>
					<h4> <a ng-href="/producer/{{product.producer_ID.producerData.companyName | forURL}}-{{product.producer_ID.name | forURL}}">
					<span class="glyphicon glyphicon-user"></span> 
					 {{product.producer_ID.producerData.companyName || product.producer_ID.name}}</a></h4>
					<h3>{{product.fullName}}</h3>
					<p>{{1.2 * product.price|currency}} / {{product.units}}</p>
					
					<!--<div ta-bind ng-model='product.description'></div>-->
					<hr>
					<p> Category: {{product.category.name}}<br>
					<span ng-if="product.certification !== 'none' ">Certified by {{product.certification.name}}</span>
					</p>
					<p ng-if="product.ingredients && product.ingredients.length > 0">Ingredients: 
					<span ng-repeat="item in product.ingredients track by $index">
						<a class="yellow-link" ng-click="searchFor(item)">{{item}} </a> 
					</span></p>
					<div class="btn-group">
						<button class="btn btn-danger pull-right" disabled ng-if="product.quantity === 0">
							SOLD OUT
						</button>
						<button class="btn btn-warning" ng-click="open(product)">
							Details
						</button>
						<button class="btn btn-primary" disabled ng-if="product.AlreadyInCart" ng-hide="product.AlreadyInCart">
							Added to Cart
						</button>
						<button class="btn btn-primary" ng-click="addToCart(product)" 
						ng-if="!product.AlreadyInCart" ng-hide="product.quantity <= 0">
							Add to Cart
						</button>
					</div>
					<div>
						<br>
						<span class="glyphicon glyphicon-envelope"></span> <a style="color:white" ng-href="/contact/{{product.producer_ID._id}}?subject=Question%20about%20{{product.fullName}}">Ask the seller about this product</a>
					</div>
				</article>
			</section>
		</li>
	</ul>
</div>

